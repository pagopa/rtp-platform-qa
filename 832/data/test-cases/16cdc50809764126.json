{"uid":"16cdc50809764126","name":"An RTP sent with synchronous rejection is in status REJECTED - DS-08P N","fullName":"functional-tests.tests.test_RTP_send_MOCK#test_send_rtp_sync_rejected_ds08p_n","historyId":"6393b9659698258af492b395ab1bd9ef","time":{"start":1771655967218,"stop":1771655969498,"duration":2280},"status":"broken","statusMessage":"KeyError: 'location'","statusTrace":"debtor_service_provider_token_a = 'Bearer eyJraWQiOiJiM2MxOWIxODA0ODg0ZGFjOGViYjY3NDhlODcyZDE0ZS83ZjFkZWQzZWQ4OTA0MzEyOTYwMjU5MDIxZjY3Y2I0MCIsImFsZyI6Il...bsfK2mMwI-Tu0kYEMT1wKnYVEkxGTay0ZzRAtiqq_-h2Ajebe6Jlsa1g7K5lr-Xz1sXP_JhuoHQt5dvmXLz1tRHoYFcyAbi4GTvOmdrm2JDt4svmStY9y8'\ncreditor_service_provider_token_a = 'Bearer eyJraWQiOiJiM2MxOWIxODA0ODg0ZGFjOGViYjY3NDhlODcyZDE0ZS83ZjFkZWQzZWQ4OTA0MzEyOTYwMjU5MDIxZjY3Y2I0MCIsImFsZyI6Il...2Z4xJsJRAY9yVNaRkYe3Hqc52wK2zjd1dWr61PU-L8_7RRfY55pLESese7w6P7FRkvDqmHoiwcVw8NiXwzhjLIHbAwJpSBlAHg8Yj2HbAyvjTzxjezQLqg'\nrtp_reader_access_token = 'Bearer eyJraWQiOiJiM2MxOWIxODA0ODg0ZGFjOGViYjY3NDhlODcyZDE0ZS83ZjFkZWQzZWQ4OTA0MzEyOTYwMjU5MDIxZjY3Y2I0MCIsImFsZyI6Il...L0TBKvt_KXqBRdkTW2dTuilcFsXpMIZlFWKZyclme09YhlPEPzYkWoMfczQ88H0mD2pc8QYTy-TXieBjfOMffwehlNEwJghjGtOhAaj4TOJBs8Jt10FGxQ'\n\n    @allure.epic('RTP Send')\n    @allure.feature('RTP Send')\n    @allure.story('Service provider sends an RTP with synchronous RJCT response')\n    @allure.title('An RTP sent with synchronous rejection is in status REJECTED - DS-08P N')\n    @allure.tag('functional', 'happy_path', 'rtp_send', 'ds_08p_n')\n    @pytest.mark.send\n    @pytest.mark.happy_path\n    def test_send_rtp_sync_rejected_ds08p_n(\n        debtor_service_provider_token_a,\n        creditor_service_provider_token_a,\n        rtp_reader_access_token,\n    ):\n        rtp_data = generate_rtp_data(payer_id=secrets.mock_rjct_fiscal_code)\n    \n        activation_response = activate(\n            debtor_service_provider_token_a,\n            rtp_data['payer']['payerId'],\n            secrets.debtor_service_provider.service_provider_id,\n        )\n        assert activation_response.status_code in (201, 409), 'Error activating debtor'\n    \n        send_response = send_rtp(\n            access_token=creditor_service_provider_token_a,\n            rtp_payload=rtp_data,\n        )\n        assert send_response.status_code == 422\n    \n>       location = send_response.headers['Location']\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nfunctional-tests/tests/test_RTP_send_MOCK.py:179: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {'Date': 'Sat, 21 Feb 2026 06:39:29 GMT', 'Content-Type': 'application/json', 'Content-Length': '75', 'Connection': 'k...ection': '0', 'Referrer-Policy': 'no-referrer', 'Request-Context': 'appId=cid-v1:6355e274-4c88-4560-bced-f1541f0207a6'}\nkey = 'Location'\n\n    def __getitem__(self, key):\n>       return self._store[key.lower()][1]\n               ^^^^^^^^^^^^^^^^^^^^^^^^\nE       KeyError: 'location'\n\n/opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/requests/structures.py:52: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1771655751680,"stop":1771655751748,"duration":68},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"debtor_service_provider_token_a","time":{"start":1771655965552,"stop":1771655966101,"duration":549},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"creditor_service_provider_token_a","time":{"start":1771655966101,"stop":1771655966677,"duration":576},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"rtp_reader_access_token","time":{"start":1771655966677,"stop":1771655967217,"duration":540},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"epic","value":"RTP Send"},{"name":"feature","value":"RTP Send"},{"name":"story","value":"Service provider sends an RTP with synchronous RJCT response"},{"name":"tag","value":"ds_08p_n"},{"name":"tag","value":"rtp_send"},{"name":"tag","value":"happy_path"},{"name":"tag","value":"functional"},{"name":"tag","value":"happy_path"},{"name":"tag","value":"send"},{"name":"parentSuite","value":"functional-tests.tests"},{"name":"suite","value":"test_RTP_send_MOCK"},{"name":"host","value":"runnervmwffz4"},{"name":"thread","value":"2697-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"functional-tests.tests.test_RTP_send_MOCK"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":2,"skipped":0,"passed":0,"unknown":0,"total":2},"items":[{"uid":"e45bf82a9539562","reportUrl":"https://pagopa.github.io/rtp-platform-qa/831/#testresult/e45bf82a9539562","status":"broken","statusDetails":"KeyError: 'location'","time":{"start":1771594662166,"stop":1771594664620,"duration":2454}}]},"tags":["rtp_send","functional","ds_08p_n","send","happy_path"]},"source":"16cdc50809764126.json","parameterValues":[]}