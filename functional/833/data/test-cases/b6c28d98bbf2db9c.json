{"uid":"b6c28d98bbf2db9c","name":"An RTP sent with synchronous rejection is in status REJECTED - DS-08P N","fullName":"functional-tests.tests.test_RTP_send_MOCK#test_send_rtp_sync_rejected_ds08p_n","historyId":"6393b9659698258af492b395ab1bd9ef","time":{"start":1771742663247,"stop":1771742666371,"duration":3124},"status":"broken","statusMessage":"KeyError: 'location'","statusTrace":"debtor_service_provider_token_a = 'Bearer eyJraWQiOiJiM2MxOWIxODA0ODg0ZGFjOGViYjY3NDhlODcyZDE0ZS83ZjFkZWQzZWQ4OTA0MzEyOTYwMjU5MDIxZjY3Y2I0MCIsImFsZyI6Il...s514PyvmF0hFPyPNWWx5319DvOwChq3ZNa0A4zzxwCu8NkMPx-6G2Tflhe-9O6MTZYza_ai3i0VL2ek29dqqdSpwW4eg8knICIRsT9-sHxMMQ9GIHjO-AE'\ncreditor_service_provider_token_a = 'Bearer eyJraWQiOiJiM2MxOWIxODA0ODg0ZGFjOGViYjY3NDhlODcyZDE0ZS83ZjFkZWQzZWQ4OTA0MzEyOTYwMjU5MDIxZjY3Y2I0MCIsImFsZyI6Il...6LJ-POau0pj2dq1QAkxlNdJcVC3FRD37S9AE8UuisqI6AQfRrER81dYktYAX2MUC1tySCpGejM506W3aGKFfkoAD3_SU6EGVI4YEp8KnnNSZUvosKgCuw8'\nrtp_reader_access_token = 'Bearer eyJraWQiOiJiM2MxOWIxODA0ODg0ZGFjOGViYjY3NDhlODcyZDE0ZS83ZjFkZWQzZWQ4OTA0MzEyOTYwMjU5MDIxZjY3Y2I0MCIsImFsZyI6Il...PsLmS47IdC8pxt4sw7hFPTjEa8BtAZ3mykDvi1Saf_6ivISWXW1AewfrJ7eposGy7eqbtXSz0su2FXwcmRzq-U-2tCkwArJJ6sg-sp5G3ojZ9OV_5cbN0k'\n\n    @allure.epic('RTP Send')\n    @allure.feature('RTP Send')\n    @allure.story('Service provider sends an RTP with synchronous RJCT response')\n    @allure.title('An RTP sent with synchronous rejection is in status REJECTED - DS-08P N')\n    @allure.tag('functional', 'happy_path', 'rtp_send', 'ds_08p_n')\n    @pytest.mark.send\n    @pytest.mark.happy_path\n    def test_send_rtp_sync_rejected_ds08p_n(\n        debtor_service_provider_token_a,\n        creditor_service_provider_token_a,\n        rtp_reader_access_token,\n    ):\n        rtp_data = generate_rtp_data(payer_id=secrets.mock_rjct_fiscal_code)\n    \n        activation_response = activate(\n            debtor_service_provider_token_a,\n            rtp_data['payer']['payerId'],\n            secrets.debtor_service_provider.service_provider_id,\n        )\n        assert activation_response.status_code in (201, 409), 'Error activating debtor'\n    \n        send_response = send_rtp(\n            access_token=creditor_service_provider_token_a,\n            rtp_payload=rtp_data,\n        )\n        assert send_response.status_code == 422\n    \n>       location = send_response.headers['Location']\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nfunctional-tests/tests/test_RTP_send_MOCK.py:179: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {'Date': 'Sun, 22 Feb 2026 06:44:26 GMT', 'Content-Type': 'application/json', 'Content-Length': '75', 'Connection': 'k...ection': '0', 'Referrer-Policy': 'no-referrer', 'Request-Context': 'appId=cid-v1:6355e274-4c88-4560-bced-f1541f0207a6'}\nkey = 'Location'\n\n    def __getitem__(self, key):\n>       return self._store[key.lower()][1]\n               ^^^^^^^^^^^^^^^^^^^^^^^^\nE       KeyError: 'location'\n\n/opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/requests/structures.py:52: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1771742450094,"stop":1771742450160,"duration":66},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"debtor_service_provider_token_a","time":{"start":1771742661704,"stop":1771742662200,"duration":496},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"creditor_service_provider_token_a","time":{"start":1771742662200,"stop":1771742662727,"duration":527},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"rtp_reader_access_token","time":{"start":1771742662727,"stop":1771742663246,"duration":519},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"tag","value":"happy_path"},{"name":"epic","value":"RTP Send"},{"name":"tag","value":"ds_08p_n"},{"name":"feature","value":"RTP Send"},{"name":"story","value":"Service provider sends an RTP with synchronous RJCT response"},{"name":"tag","value":"rtp_send"},{"name":"tag","value":"functional"},{"name":"tag","value":"happy_path"},{"name":"tag","value":"send"},{"name":"parentSuite","value":"functional-tests.tests"},{"name":"suite","value":"test_RTP_send_MOCK"},{"name":"host","value":"runnervmwffz4"},{"name":"thread","value":"2670-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"functional-tests.tests.test_RTP_send_MOCK"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":3,"skipped":0,"passed":0,"unknown":0,"total":3},"items":[{"uid":"a92417630d841dd4","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/832/#testresult/a92417630d841dd4","status":"broken","statusDetails":"KeyError: 'location'","time":{"start":1771655967218,"stop":1771655969498,"duration":2280}},{"uid":"a171d8a2684b1ad6","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/831/#testresult/a171d8a2684b1ad6","status":"broken","statusDetails":"KeyError: 'location'","time":{"start":1771594662166,"stop":1771594664620,"duration":2454}}]},"tags":["rtp_send","functional","ds_08p_n","send","happy_path"]},"source":"b6c28d98bbf2db9c.json","parameterValues":[]}