{"uid":"4dd458cbdbd1ebf9","name":"Cannot send RTP with invalid amount","fullName":"functional-tests.tests.test_availability_POSTE#test_send_rtp_to_poste_invalid_amount","historyId":"140c1c322aedb19168a9141570c2a522","time":{"start":1770533206047,"stop":1770533206882,"duration":835},"description":"\nTests that sending an RTP payload with an invalid amount to the POSTE endpoint results in a 400 Bad Request response.\n\n:param debtor_sp_mock_cert_key: Certificate and key tuple for mutual TLS authentication.\n:type debtor_sp_mock_cert_key: Tuple[str, str]\n","descriptionHtml":"<p>Tests that sending an RTP payload with an invalid amount to the POSTE endpoint results in a 400 Bad Request response.</p>\n<p>:param debtor_sp_mock_cert_key: Certificate and key tuple for mutual TLS authentication.<br />\n:type debtor_sp_mock_cert_key: Tuple[str, str]</p>\n","status":"failed","statusMessage":"AssertionError: assert 502 == 400\n +  where 502 = <Response [502]>.status_code","statusTrace":"debtor_sp_mock_cert_key = ('/home/runner/work/rtp-platform-qa/rtp-platform-qa/config/cert.pem', '/home/runner/work/rtp-platform-qa/rtp-platform-qa/config/key.pem')\n\n    @allure.epic('POSTE Availability')\n    @allure.feature('RTP Send')\n    @allure.story('Service provider sends an RTP to POSTE')\n    @allure.title('Cannot send RTP with invalid amount')\n    @allure.tag('functional', 'unhappy_path', 'rtp_send', 'poste_availability')\n    @pytest.mark.send\n    @pytest.mark.unhappy_path\n    @pytest.mark.poste\n    def test_send_rtp_to_poste_invalid_amount(debtor_sp_mock_cert_key: Tuple[str, str]):\n        \"\"\"\n        Tests that sending an RTP payload with an invalid amount to the POSTE endpoint results in a 400 Bad Request response.\n    \n        :param debtor_sp_mock_cert_key: Certificate and key tuple for mutual TLS authentication.\n        :type debtor_sp_mock_cert_key: Tuple[str, str]\n        \"\"\"\n        cert, key = debtor_sp_mock_cert_key\n    \n        rtp_data = generate_rtp_data()\n        rtp_data['paymentNotice']['amount'] = -1\n        poste_payload = generate_epc_rtp_data(rtp_data, bic='PPAYITR1XXX')\n        token = get_poste_access_token(\n            cert, key, secrets.poste_oauth.client_id, secrets.poste_oauth.client_secret)\n        response = send_srtp_to_poste(token, poste_payload)\n    \n>       assert response.status_code == 400\nE       assert 502 == 400\nE        +  where 502 = <Response [502]>.status_code\n\nfunctional-tests/tests/test_availability_POSTE.py:85: AssertionError","flaky":false,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1770532985336,"stop":1770532985403,"duration":67},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"debtor_sp_mock_cert_key","time":{"start":1770533206004,"stop":1770533206047,"duration":43},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"tag","value":"poste_availability"},{"name":"story","value":"Service provider sends an RTP to POSTE"},{"name":"epic","value":"POSTE Availability"},{"name":"feature","value":"RTP Send"},{"name":"tag","value":"unhappy_path"},{"name":"tag","value":"functional"},{"name":"tag","value":"rtp_send"},{"name":"tag","value":"poste"},{"name":"tag","value":"unhappy_path"},{"name":"tag","value":"send"},{"name":"parentSuite","value":"functional-tests.tests"},{"name":"suite","value":"test_availability_POSTE"},{"name":"host","value":"runnervmwffz4"},{"name":"thread","value":"2650-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"functional-tests.tests.test_availability_POSTE"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":0,"skipped":0,"passed":110,"unknown":0,"total":112},"items":[{"uid":"53868870e767a2b5","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/814/#testresult/53868870e767a2b5","status":"passed","time":{"start":1770446350397,"stop":1770446351299,"duration":902}},{"uid":"f1ce8c7401571d33","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/813/#testresult/f1ce8c7401571d33","status":"passed","time":{"start":1770360693062,"stop":1770360694525,"duration":1463}},{"uid":"df53167e5b151df7","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/812/#testresult/df53167e5b151df7","status":"passed","time":{"start":1770290098205,"stop":1770290099734,"duration":1529}},{"uid":"dce0f45b6dd84bf6","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/811/#testresult/dce0f45b6dd84bf6","status":"passed","time":{"start":1770289277290,"stop":1770289278564,"duration":1274}},{"uid":"f2a912f2a7a21072","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/810/#testresult/f2a912f2a7a21072","status":"passed","time":{"start":1770288762357,"stop":1770288764292,"duration":1935}},{"uid":"6fd2269c171b98a5","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/809/#testresult/6fd2269c171b98a5","status":"passed","time":{"start":1770274484915,"stop":1770274485588,"duration":673}},{"uid":"2c41e8f59cdb4677","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/808/#testresult/2c41e8f59cdb4677","status":"passed","time":{"start":1770222439963,"stop":1770222440740,"duration":777}},{"uid":"aa409e24217ec0aa","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/807/#testresult/aa409e24217ec0aa","status":"passed","time":{"start":1770219313748,"stop":1770219314783,"duration":1035}},{"uid":"18d0b2514dfc2749","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/806/#testresult/18d0b2514dfc2749","status":"passed","time":{"start":1770200981738,"stop":1770200983066,"duration":1328}},{"uid":"1a6d9b070bc4cc5a","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/805/#testresult/1a6d9b070bc4cc5a","status":"passed","time":{"start":1770195617985,"stop":1770195619031,"duration":1046}},{"uid":"5a883bf506246c17","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/804/#testresult/5a883bf506246c17","status":"passed","time":{"start":1770187527210,"stop":1770187527918,"duration":708}},{"uid":"4e474b098a6405ed","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/803/#testresult/4e474b098a6405ed","status":"passed","time":{"start":1770101118129,"stop":1770101119078,"duration":949}},{"uid":"4eb64627339d4b2","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/802/#testresult/4eb64627339d4b2","status":"passed","time":{"start":1770032534673,"stop":1770032535765,"duration":1092}},{"uid":"530c464e87c2fb55","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/801/#testresult/530c464e87c2fb55","status":"passed","time":{"start":1770015548290,"stop":1770015548988,"duration":698}},{"uid":"5b45fe2e7647e761","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/800/#testresult/5b45fe2e7647e761","status":"passed","time":{"start":1769928281940,"stop":1769928283016,"duration":1076}},{"uid":"27f2998558bc2bcc","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/799/#testresult/27f2998558bc2bcc","status":"passed","time":{"start":1769841229328,"stop":1769841230095,"duration":767}},{"uid":"9e093301513f414f","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/798/#testresult/9e093301513f414f","status":"passed","time":{"start":1769755382713,"stop":1769755383437,"duration":724}},{"uid":"861e6b1dd128659e","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/797/#testresult/861e6b1dd128659e","status":"passed","time":{"start":1769668965571,"stop":1769668966531,"duration":960}},{"uid":"972503cdf8ea6652","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/796/#testresult/972503cdf8ea6652","status":"passed","time":{"start":1769617202001,"stop":1769617203691,"duration":1690}},{"uid":"831896ba378a64b","reportUrl":"https://pagopa.github.io/rtp-platform-qa/functional/795/#testresult/831896ba378a64b","status":"passed","time":{"start":1769581913122,"stop":1769581914104,"duration":982}}]},"tags":["rtp_send","functional","poste_availability","poste","unhappy_path","send"]},"source":"4dd458cbdbd1ebf9.json","parameterValues":[]}