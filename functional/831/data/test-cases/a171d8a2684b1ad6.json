{"uid":"a171d8a2684b1ad6","name":"An RTP sent with synchronous rejection is in status REJECTED - DS-08P N","fullName":"functional-tests.tests.test_RTP_send_MOCK#test_send_rtp_sync_rejected_ds08p_n","historyId":"6393b9659698258af492b395ab1bd9ef","time":{"start":1771594662166,"stop":1771594664620,"duration":2454},"status":"broken","statusMessage":"KeyError: 'location'","statusTrace":"debtor_service_provider_token_a = 'Bearer eyJraWQiOiJiM2MxOWIxODA0ODg0ZGFjOGViYjY3NDhlODcyZDE0ZS83ZjFkZWQzZWQ4OTA0MzEyOTYwMjU5MDIxZjY3Y2I0MCIsImFsZyI6Il...THAdcg4u2OK2AcpSBNPU7tZYjrSgqwaOH5O-sSgTqcWZhYe3A1ry5Fjv2I2TycAHXRFtG33gNmXVPR4CytMRMBu_3RyG4R42vhjKoXYFVjmMHaxpdRClJ4'\ncreditor_service_provider_token_a = 'Bearer eyJraWQiOiJiM2MxOWIxODA0ODg0ZGFjOGViYjY3NDhlODcyZDE0ZS83ZjFkZWQzZWQ4OTA0MzEyOTYwMjU5MDIxZjY3Y2I0MCIsImFsZyI6Il...ftp4kLPcdLP8pZz39McZnwRPwti9ckW7FbShVTWjsrtThIVtaNIxdgocHq-xag5CKtnO9JkUpMcV3Lo753D3YyoY7zFMPgM72NhmjikSfR3MiYajmO16sU'\nrtp_reader_access_token = 'Bearer eyJraWQiOiJiM2MxOWIxODA0ODg0ZGFjOGViYjY3NDhlODcyZDE0ZS83ZjFkZWQzZWQ4OTA0MzEyOTYwMjU5MDIxZjY3Y2I0MCIsImFsZyI6Il...eMeZPb3JV0w2J-red0zEFIynDk4hi9i9uxKm88J7Rw74CNNeJC7Vf5wQBQ1caS5VBJrUZo47mGs7MWV64Bkm7wwau0UUrEZpZsoCeJfwBiiffp5zFG9Hjo'\n\n    @allure.epic('RTP Send')\n    @allure.feature('RTP Send')\n    @allure.story('Service provider sends an RTP with synchronous RJCT response')\n    @allure.title('An RTP sent with synchronous rejection is in status REJECTED - DS-08P N')\n    @allure.tag('functional', 'happy_path', 'rtp_send', 'ds_08p_n')\n    @pytest.mark.send\n    @pytest.mark.happy_path\n    def test_send_rtp_sync_rejected_ds08p_n(\n        debtor_service_provider_token_a,\n        creditor_service_provider_token_a,\n        rtp_reader_access_token,\n    ):\n        rtp_data = generate_rtp_data(payer_id=secrets.mock_rjct_fiscal_code)\n    \n        activation_response = activate(\n            debtor_service_provider_token_a,\n            rtp_data['payer']['payerId'],\n            secrets.debtor_service_provider.service_provider_id,\n        )\n        assert activation_response.status_code in (201, 409), 'Error activating debtor'\n    \n        send_response = send_rtp(\n            access_token=creditor_service_provider_token_a,\n            rtp_payload=rtp_data,\n        )\n        assert send_response.status_code == 422\n    \n>       location = send_response.headers['Location']\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nfunctional-tests/tests/test_RTP_send_MOCK.py:179: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {'Date': 'Fri, 20 Feb 2026 13:37:44 GMT', 'Content-Type': 'application/json', 'Content-Length': '75', 'Connection': 'k...ection': '0', 'Referrer-Policy': 'no-referrer', 'Request-Context': 'appId=cid-v1:6355e274-4c88-4560-bced-f1541f0207a6'}\nkey = 'Location'\n\n    def __getitem__(self, key):\n>       return self._store[key.lower()][1]\n               ^^^^^^^^^^^^^^^^^^^^^^^^\nE       KeyError: 'location'\n\n/opt/hostedtoolcache/Python/3.14.2/x64/lib/python3.14/site-packages/requests/structures.py:52: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1771594530687,"stop":1771594530754,"duration":67},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"debtor_service_provider_token_a","time":{"start":1771594661036,"stop":1771594661400,"duration":364},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"creditor_service_provider_token_a","time":{"start":1771594661400,"stop":1771594661787,"duration":387},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"rtp_reader_access_token","time":{"start":1771594661788,"stop":1771594662166,"duration":378},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[],"labels":[{"name":"tag","value":"happy_path"},{"name":"tag","value":"functional"},{"name":"epic","value":"RTP Send"},{"name":"tag","value":"ds_08p_n"},{"name":"feature","value":"RTP Send"},{"name":"story","value":"Service provider sends an RTP with synchronous RJCT response"},{"name":"tag","value":"rtp_send"},{"name":"tag","value":"happy_path"},{"name":"tag","value":"send"},{"name":"parentSuite","value":"functional-tests.tests"},{"name":"suite","value":"test_RTP_send_MOCK"},{"name":"host","value":"runnervmwffz4"},{"name":"thread","value":"2645-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"functional-tests.tests.test_RTP_send_MOCK"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":["rtp_send","functional","ds_08p_n","send","happy_path"]},"source":"a171d8a2684b1ad6.json","parameterValues":[]}